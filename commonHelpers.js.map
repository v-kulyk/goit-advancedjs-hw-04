{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '44459429-c3864503d57e6d0fc4818852c';\nconst PER_PAGE = 40;\n\nconst refs = {\n  searchForm: document.querySelector('#search-form'),\n  container: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\nconst lightbox = new SimpleLightbox('.gallery a');\n\nlet page = 1;\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  const searchQuery = refs.searchForm.elements.searchQuery.value;\n\n  if (searchQuery === '') {\n    return;\n  }\n\n  refs.container.innerHTML = '';\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n\n  try {\n    const data = await loadData(searchQuery, page);\n\n    if (data.hits.length === 0) {\n      return;\n    } else {\n      showFetchSuccessMessage(data.totalHits);\n    }\n\n    const elements = data.hits.reduce((carry, item) => {\n      return carry + buildImageCard(item);\n    }, '');\n\n    refs.container.insertAdjacentHTML('beforeend', elements);\n\n    if (data.totalHits > PER_PAGE * page) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      showEndOfFeedMessage();\n      refs.loadMoreBtn.classList.add('is-hidden');\n    }\n\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    showError();\n    return;\n  }\n}\n\nfunction buildImageCard(item) {\n  return `<div class=\"photo-card\">\n            <a href=\"${item.largeImageURL}\">\n                <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b>\n                    ${item.likes}\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b>\n                    ${item.views}\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b>\n                    ${item.comments}\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b>\n                    ${item.downloads}\n                </p>\n            </div>\n        </div>`;\n}\n\nasync function loadData(searchQuery, page = 1) {\n  const params = {\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: PER_PAGE,\n    page: page,\n    key: API_KEY,\n  };\n\n  const response = await axios.get(BASE_URL, { params });\n\n  return response.data;\n}\n\nfunction showError() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Something went wrong. Please try again later.',\n  });\n}\n\nfunction showFetchSuccessMessage(totalHits) {\n  iziToast.success({\n    title: 'Success',\n    message: `Hooray! We found ${totalHits} images.`,\n  });\n}\n\nfunction showEndOfFeedMessage() {\n  iziToast.info({\n    title: 'End of feed',\n    message: `We're sorry, but you've reached the end of search results.`,\n  });\n}\n\nasync function onLoadMore(e) {\n  page += 1;\n\n  try {\n    const data = await loadData(\n      refs.searchForm.elements.searchQuery.value,\n      page\n    );\n\n    if (data.hits.length === 0) {\n      return;\n    }\n\n    const elements = data.hits.reduce((carry, item) => {\n      return carry + buildImageCard(item);\n    }, '');\n\n    refs.container.insertAdjacentHTML('beforeend', elements);\n\n    if (data.totalHits > PER_PAGE * page) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      showEndOfFeedMessage();\n    }\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    showError();\n    return;\n  }\n}\n\nrefs.searchForm.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n"],"names":["BASE_URL","API_KEY","PER_PAGE","refs","lightbox","SimpleLightbox","page","onSearch","e","searchQuery","data","loadData","showFetchSuccessMessage","elements","carry","item","buildImageCard","showEndOfFeedMessage","error","showError","params","axios","iziToast","totalHits","onLoadMore"],"mappings":"owBAMA,MAAMA,EAAW,2BACXC,EAAU,qCACVC,EAAW,GAEXC,EAAO,CACX,WAAY,SAAS,cAAc,cAAc,EACjD,UAAW,SAAS,cAAc,UAAU,EAC5C,YAAa,SAAS,cAAc,YAAY,CAClD,EACMC,EAAW,IAAIC,EAAe,YAAY,EAEhD,IAAIC,EAAO,EAEX,eAAeC,EAASC,EAAG,CACzBA,EAAE,eAAc,EAEhB,MAAMC,EAAcN,EAAK,WAAW,SAAS,YAAY,MAEzD,GAAIM,IAAgB,GAIpB,CAAAN,EAAK,UAAU,UAAY,GAE3BA,EAAK,YAAY,UAAU,IAAI,WAAW,EAE1C,GAAI,CACF,MAAMO,EAAO,MAAMC,EAASF,EAAaH,CAAI,EAE7C,GAAII,EAAK,KAAK,SAAW,EACvB,OAEAE,EAAwBF,EAAK,SAAS,EAGxC,MAAMG,EAAWH,EAAK,KAAK,OAAO,CAACI,EAAOC,IACjCD,EAAQE,EAAeD,CAAI,EACjC,EAAE,EAELZ,EAAK,UAAU,mBAAmB,YAAaU,CAAQ,EAEnDH,EAAK,UAAYR,EAAWI,EAC9BH,EAAK,YAAY,UAAU,OAAO,WAAW,GAE7Cc,IACAd,EAAK,YAAY,UAAU,IAAI,WAAW,GAG5CC,EAAS,QAAO,CACjB,OAAQc,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBC,IACA,MACD,EACH,CAEA,SAASH,EAAeD,EAAM,CAC5B,MAAO;AAAA,uBACcA,EAAK,aAAa;AAAA,4BACbA,EAAK,YAAY,UAAUA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,sBAK1CA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,sBAIVA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,sBAIVA,EAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,sBAIbA,EAAK,SAAS;AAAA;AAAA;AAAA,eAIpC,CAEA,eAAeJ,EAASF,EAAaH,EAAO,EAAG,CAC7C,MAAMc,EAAS,CACb,EAAGX,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAUP,EACV,KAAMI,EACN,IAAKL,CACT,EAIE,OAFiB,MAAMoB,EAAM,IAAIrB,EAAU,CAAE,OAAAoB,CAAM,CAAE,GAErC,IAClB,CAEA,SAASD,GAAY,CACnBG,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACb,CAAG,CACH,CAEA,SAASV,EAAwBW,EAAW,CAC1CD,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBC,CAAS,UAC1C,CAAG,CACH,CAEA,SAASN,GAAuB,CAC9BK,EAAS,KAAK,CACZ,MAAO,cACP,QAAS,4DACb,CAAG,CACH,CAEA,eAAeE,EAAWhB,EAAG,CAC3BF,GAAQ,EAER,GAAI,CACF,MAAMI,EAAO,MAAMC,EACjBR,EAAK,WAAW,SAAS,YAAY,MACrCG,CACN,EAEI,GAAII,EAAK,KAAK,SAAW,EACvB,OAGF,MAAMG,EAAWH,EAAK,KAAK,OAAO,CAACI,EAAOC,IACjCD,EAAQE,EAAeD,CAAI,EACjC,EAAE,EAELZ,EAAK,UAAU,mBAAmB,YAAaU,CAAQ,EAEnDH,EAAK,UAAYR,EAAWI,EAC9BH,EAAK,YAAY,UAAU,OAAO,WAAW,GAE7CA,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1Cc,KAEFb,EAAS,QAAO,CACjB,OAAQc,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBC,IACA,MACD,CACH,CAEAhB,EAAK,WAAW,iBAAiB,SAAUI,CAAQ,EACnDJ,EAAK,YAAY,iBAAiB,QAASqB,CAAU"}