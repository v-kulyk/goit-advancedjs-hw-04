{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '44459429-c3864503d57e6d0fc4818852c';\nconst PER_PAGE = 40;\n\nconst refs = {\n  searchForm: document.querySelector('#search-form'),\n  container: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\nconst lightbox = new SimpleLightbox('.gallery a');\n\nlet page = 1;\nlet searchQuery;\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  searchQuery = refs.searchForm.elements.searchQuery.value.trim();\n\n  if (searchQuery === '') {\n    return;\n  }\n\n  refs.container.innerHTML = '';\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n\n  page = 1;\n\n  try {\n    const data = await loadData(searchQuery, page);\n\n    if (data.hits.length === 0) {\n      showNothingFoundMessage();\n      return;\n    } else {\n      showFetchSuccessMessage(data.totalHits);\n    }\n\n    const elements = data.hits.reduce((carry, item) => {\n      return carry + buildImageCard(item);\n    }, '');\n\n    refs.container.insertAdjacentHTML('beforeend', elements);\n\n    if (data.totalHits > PER_PAGE * page) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      showEndOfFeedMessage();\n      refs.loadMoreBtn.classList.add('is-hidden');\n    }\n\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    showError();\n    return;\n  }\n}\n\nfunction buildImageCard(item) {\n  return `<div class=\"photo-card\">\n            <a href=\"${item.largeImageURL}\">\n                <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b>\n                    ${item.likes}\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b>\n                    ${item.views}\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b>\n                    ${item.comments}\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b>\n                    ${item.downloads}\n                </p>\n            </div>\n        </div>`;\n}\n\nasync function loadData(searchQuery, page = 1) {\n  const params = {\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: PER_PAGE,\n    page: page,\n    key: API_KEY,\n  };\n\n  const response = await axios.get(BASE_URL, { params });\n\n  return response.data;\n}\n\nfunction showError() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Something went wrong. Please try again later.',\n  });\n}\n\nfunction showFetchSuccessMessage(totalHits) {\n  iziToast.success({\n    title: 'Success',\n    message: `Hooray! We found ${totalHits} images.`,\n  });\n}\n\nfunction showNothingFoundMessage() {\n  iziToast.info({\n    title: 'Nothing found',\n    message:\n      'Sorry, there are no images matching your search query. Please try again.',\n  });\n}\n\nfunction showEndOfFeedMessage() {\n  iziToast.info({\n    title: 'End of feed',\n    message: `We're sorry, but you've reached the end of search results.`,\n  });\n}\n\nasync function onLoadMore(e) {\n  page += 1;\n\n  try {\n    const data = await loadData(searchQuery, page);\n\n    if (data.hits.length === 0) {\n      return;\n    }\n\n    const elements = data.hits.reduce((carry, item) => {\n      return carry + buildImageCard(item);\n    }, '');\n\n    refs.container.insertAdjacentHTML('beforeend', elements);\n\n    if (data.totalHits > PER_PAGE * page) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      showEndOfFeedMessage();\n    }\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    showError();\n    return;\n  }\n}\n\nrefs.searchForm.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n"],"names":["BASE_URL","API_KEY","PER_PAGE","refs","lightbox","SimpleLightbox","page","searchQuery","onSearch","e","data","loadData","showNothingFoundMessage","showFetchSuccessMessage","elements","carry","item","buildImageCard","showEndOfFeedMessage","error","showError","params","axios","iziToast","totalHits","onLoadMore"],"mappings":"owBAMA,MAAMA,EAAW,2BACXC,EAAU,qCACVC,EAAW,GAEXC,EAAO,CACX,WAAY,SAAS,cAAc,cAAc,EACjD,UAAW,SAAS,cAAc,UAAU,EAC5C,YAAa,SAAS,cAAc,YAAY,CAClD,EACMC,EAAW,IAAIC,EAAe,YAAY,EAEhD,IAAIC,EAAO,EACPC,EAEJ,eAAeC,EAASC,EAAG,CAKzB,GAJAA,EAAE,eAAc,EAEhBF,EAAcJ,EAAK,WAAW,SAAS,YAAY,MAAM,OAErDI,IAAgB,GAIpB,CAAAJ,EAAK,UAAU,UAAY,GAE3BA,EAAK,YAAY,UAAU,IAAI,WAAW,EAE1CG,EAAO,EAEP,GAAI,CACF,MAAMI,EAAO,MAAMC,EAASJ,EAAaD,CAAI,EAE7C,GAAII,EAAK,KAAK,SAAW,EAAG,CAC1BE,IACA,MACN,MACMC,EAAwBH,EAAK,SAAS,EAGxC,MAAMI,EAAWJ,EAAK,KAAK,OAAO,CAACK,EAAOC,IACjCD,EAAQE,EAAeD,CAAI,EACjC,EAAE,EAELb,EAAK,UAAU,mBAAmB,YAAaW,CAAQ,EAEnDJ,EAAK,UAAYR,EAAWI,EAC9BH,EAAK,YAAY,UAAU,OAAO,WAAW,GAE7Ce,IACAf,EAAK,YAAY,UAAU,IAAI,WAAW,GAG5CC,EAAS,QAAO,CACjB,OAAQe,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBC,IACA,MACD,EACH,CAEA,SAASH,EAAeD,EAAM,CAC5B,MAAO;AAAA,uBACcA,EAAK,aAAa;AAAA,4BACbA,EAAK,YAAY,UAAUA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,sBAK1CA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,sBAIVA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,sBAIVA,EAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,sBAIbA,EAAK,SAAS;AAAA;AAAA;AAAA,eAIpC,CAEA,eAAeL,EAASJ,EAAaD,EAAO,EAAG,CAC7C,MAAMe,EAAS,CACb,EAAGd,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAUL,EACV,KAAMI,EACN,IAAKL,CACT,EAIE,OAFiB,MAAMqB,EAAM,IAAItB,EAAU,CAAE,OAAAqB,CAAM,CAAE,GAErC,IAClB,CAEA,SAASD,GAAY,CACnBG,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACb,CAAG,CACH,CAEA,SAASV,EAAwBW,EAAW,CAC1CD,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBC,CAAS,UAC1C,CAAG,CACH,CAEA,SAASZ,GAA0B,CACjCW,EAAS,KAAK,CACZ,MAAO,gBACP,QACE,0EACN,CAAG,CACH,CAEA,SAASL,GAAuB,CAC9BK,EAAS,KAAK,CACZ,MAAO,cACP,QAAS,4DACb,CAAG,CACH,CAEA,eAAeE,EAAWhB,EAAG,CAC3BH,GAAQ,EAER,GAAI,CACF,MAAMI,EAAO,MAAMC,EAASJ,EAAaD,CAAI,EAE7C,GAAII,EAAK,KAAK,SAAW,EACvB,OAGF,MAAMI,EAAWJ,EAAK,KAAK,OAAO,CAACK,EAAOC,IACjCD,EAAQE,EAAeD,CAAI,EACjC,EAAE,EAELb,EAAK,UAAU,mBAAmB,YAAaW,CAAQ,EAEnDJ,EAAK,UAAYR,EAAWI,EAC9BH,EAAK,YAAY,UAAU,OAAO,WAAW,GAE7CA,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1Ce,KAEFd,EAAS,QAAO,CACjB,OAAQe,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBC,IACA,MACD,CACH,CAEAjB,EAAK,WAAW,iBAAiB,SAAUK,CAAQ,EACnDL,EAAK,YAAY,iBAAiB,QAASsB,CAAU"}